// vbc brawl v22 script, search for 9339 and redirecthost deobfuscated by albyxhacc
var _0xc6e4 = ["loginMessagePtr", "newOperator", "base", "serverConnection", "selectReturn", "messaging", "messageFactory", "recvQueue", "state", "createMessageByType", "returnAddress", "pthreadReturn", "context", "equals", "replace", "exports", "libg.so", "detachAll", "findExportByName", "libc.so", "void", "pointer", "pthread_mutex_unlock", "int", "pthread_cond_signal", "select", "memmove", "uint16", "inet_addr", "send", "use", "java.lang.Runtime", "loadLibrary", "overload", "java.lang.String", "dalvik.system.VMStack", "implementation", "loadLibrary0", "getRuntime", "getCallingClassLoader", "lib", "add", "readInt", "writeInt", "readPointer", "writePointer", "readU8", "writeU8", "sub", "attach", "connect", "readU16", "toInt32", "options", "allocUtf8String", "wakeUpReturnArray", "length", "push", "sendQueue"];
(function (_0x636603, _0x37a24b) {
  var _0x47c8e5 = function (_0x577ac7) {
    while (--_0x577ac7) {
      _0x636603.push(_0x636603.shift());
    }
  };
  _0x47c8e5(++_0x37a24b);
}(_0xc6e4, 372));
var _0x156a = function (_0x3326b3, _0x2516dc) {
  _0x3326b3 = _0x3326b3 - 0;
  var _0x446152 = _0xc6e4[_0x3326b3];
  return _0x446152;
};
var _0x239fe4 = {modules: {}, options: {}}, _0xee10aa = 10516920, _0x3cf931 = 6569813, _0x469d01 = [287916, 830640, 856340, 3674528, 5035728, 5123960], _0x4bd429 = 6383899, _0xabda23 = 2038440, _0x47056d = 3859776, _0x36b8e6 = 4, _0x3a74dd = new NativeFunction(Module[_0x156a("0x0")](_0x156a("0x1"), "free"), _0x156a("0x2"), [_0x156a("0x3")]), _0x1ec330 = new NativeFunction(Module.findExportByName(_0x156a("0x1"), "pthread_mutex_lock"), "int", ["pointer"]), _0x45a2d1 = new NativeFunction(Module[_0x156a("0x0")](_0x156a("0x1"), _0x156a("0x4")), _0x156a("0x5"), [_0x156a("0x3")]), _0x44ae0b = new NativeFunction(Module[_0x156a("0x0")](_0x156a("0x1"), _0x156a("0x6")), "int", [_0x156a("0x3")]), _0x3e9865 = new NativeFunction(Module.findExportByName(_0x156a("0x1"), _0x156a("0x7")), "int", [_0x156a("0x5"), _0x156a("0x3"), "pointer", "pointer", _0x156a("0x3")]), _0x69232a = new NativeFunction(Module[_0x156a("0x0")]("libc.so", _0x156a("0x8")), _0x156a("0x3"), ["pointer", _0x156a("0x3"), _0x156a("0x5")]), _0x5ae588 = new NativeFunction(Module[_0x156a("0x0")](_0x156a("0x1"), "ntohs"), _0x156a("0x9"), ["uint16"]), _0x17e3ad = new NativeFunction(Module.findExportByName("libc.so", _0x156a("0xa")), _0x156a("0x5"), [_0x156a("0x3")]), _0xb09559 = new NativeFunction(Module[_0x156a("0x0")]("libc.so", _0x156a("0xb")), _0x156a("0x5"), [_0x156a("0x5"), _0x156a("0x3"), "int", "int"]), _0x30d332 = new NativeFunction(Module[_0x156a("0x0")](_0x156a("0x1"), "recv"), _0x156a("0x5"), [_0x156a("0x5"), _0x156a("0x3"), _0x156a("0x5"), "int"]);
function _0x3b63ae(_0x581449, _0x2d8f6b) {
  Java.perform(function () {
    var _0x4280a4 = Java[_0x156a("0xc")]("java.lang.System"), _0x3832fb = Java[_0x156a("0xc")](_0x156a("0xd")), _0x11ae0c = _0x4280a4[_0x156a("0xe")][_0x156a("0xf")](_0x156a("0x10")), _0x1cfd7d = Java[_0x156a("0xc")](_0x156a("0x11"));
    _0x11ae0c[_0x156a("0x12")] = function (_0x4280a4) {
      try {
        _0x3832fb.getRuntime()[_0x156a("0x13")] ? _0x3832fb[_0x156a("0x14")]()[_0x156a("0x13")](_0x1cfd7d[_0x156a("0x15")](), _0x4280a4) : _0x3832fb.getRuntime()[_0x156a("0xe")](_0x4280a4, _0x1cfd7d[_0x156a("0x15")]()), _0x581449 === _0x156a("0x16") + _0x4280a4 + ".so" && _0x2d8f6b();
      } catch (_0x2c9f05) {}
    };
  });
}
var _0x4158c3 = {e: function (_0x539d3e) {
  return _0x539d3e[_0x156a("0x17")](8);
}, n: function (_0x46deae) {
  return Memory[_0x156a("0x18")](_0x46deae[_0x156a("0x17")](4));
}, t: function (_0xf4c77f, _0x4ea044) {
  Memory[_0x156a("0x19")](_0xf4c77f[_0x156a("0x17")](4), _0x4ea044);
}, o: function (_0x131971) {
  return new NativeFunction(Memory.readPointer(Memory.readPointer(_0x131971)[_0x156a("0x17")](20)), _0x156a("0x5"), ["pointer"])(_0x131971);
}, c: function (_0x26f0be) {
  new NativeFunction(Memory[_0x156a("0x1a")](Memory[_0x156a("0x1a")](_0x26f0be)[_0x156a("0x17")](8)), "void", [_0x156a("0x3")])(_0x26f0be);
}, r: function (_0x5e4099) {
  new NativeFunction(Memory[_0x156a("0x1a")](Memory[_0x156a("0x1a")](_0x5e4099)[_0x156a("0x17")](12)), "void", [_0x156a("0x3")])(_0x5e4099);
}, i: function (_0x1ca66b) {
  new NativeFunction(Memory.readPointer(Memory[_0x156a("0x1a")](_0x1ca66b)[_0x156a("0x17")](24)), _0x156a("0x2"), [_0x156a("0x3")])(_0x1ca66b), new NativeFunction(Memory[_0x156a("0x1a")](Memory[_0x156a("0x1a")](_0x1ca66b).add(4)), _0x156a("0x2"), [_0x156a("0x3")])(_0x1ca66b);
}}, _0x385c38 = {a: function (_0x34ba5f) {
  return Memory.readInt(_0x34ba5f[_0x156a("0x17")](16));
}, u: function (_0x24d022) {
  return Memory[_0x156a("0x1a")](_0x24d022[_0x156a("0x17")](28));
}, s: function (_0x553c0d, _0x5eaef6) {
  Memory[_0x156a("0x1b")](_0x553c0d.add(28), _0x5eaef6);
}, M: function (_0x78f7d2) {
  return Memory[_0x156a("0x18")](_0x78f7d2[_0x156a("0x17")](20));
}, _: function (_0x3b3306, _0x8f244b) {
  Memory.writeInt(_0x3b3306[_0x156a("0x17")](20), _0x8f244b);
}}, _0x58c06e = {m: function (_0x58a3ac) {
  return Memory[_0x156a("0x1c")](_0x58a3ac[_0x156a("0x17")](2)) << 16 | Memory[_0x156a("0x1c")](_0x58a3ac[_0x156a("0x17")](3)) << 8 | Memory[_0x156a("0x1c")](_0x58a3ac[_0x156a("0x17")](4));
}, h: function (_0x1d83c4, _0x47f3ce) {
  Memory[_0x156a("0x1d")](_0x1d83c4[_0x156a("0x17")](2), _0x47f3ce >> 16 & 255), Memory[_0x156a("0x1d")](_0x1d83c4.add(3), _0x47f3ce >> 8 & 255), Memory[_0x156a("0x1d")](_0x1d83c4.add(4), 255 & _0x47f3ce);
}, f: function (_0x40fd8b, _0x555c4f) {
  Memory[_0x156a("0x1d")](_0x40fd8b[_0x156a("0x17")](0), _0x555c4f >> 8 & 255), Memory[_0x156a("0x1d")](_0x40fd8b.add(1), 255 & _0x555c4f);
}, y: function (_0x17a6f8) {
  return Memory[_0x156a("0x1c")](_0x17a6f8.add(5)) << 8 | Memory.readU8(_0x17a6f8[_0x156a("0x17")](6));
}, g: function (_0x1a6f8a, _0x3d42b2) {
  Memory[_0x156a("0x1d")](_0x1a6f8a[_0x156a("0x17")](5), _0x3d42b2 >> 8 & 255), Memory[_0x156a("0x1d")](_0x1a6f8a.add(6), 255 & _0x3d42b2);
}, o: function (_0x4da2ec) {
  return Memory[_0x156a("0x1c")](_0x4da2ec) << 8 | Memory.readU8(_0x4da2ec[_0x156a("0x17")](1));
}}, _0x3f7b33 = {l: function (_0x2b8450) {
  return Memory[_0x156a("0x18")](_0x2b8450[_0x156a("0x17")](4));
}, d: function (_0x35efd8, _0x3627f9) {
  return Memory.readPointer(Memory.readPointer(_0x35efd8)[_0x156a("0x17")](_0x36b8e6 * _0x3627f9));
}, v: function (_0x227c01, _0x36d7b6, _0x5ab8f2) {
  Memory[_0x156a("0x1b")](Memory.readPointer(_0x227c01)[_0x156a("0x17")](_0x36b8e6 * _0x36d7b6), _0x5ab8f2);
}, p: function (_0x276ec9) {
  return Memory[_0x156a("0x18")](_0x276ec9[_0x156a("0x17")](8));
}, N: function (_0x19684d) {
  Memory.writeInt(_0x19684d[_0x156a("0x17")](8), Memory[_0x156a("0x18")](_0x19684d.add(8)) - 1);
}, R: function (_0x22541f) {
  Memory[_0x156a("0x19")](_0x22541f[_0x156a("0x17")](8), Memory.readInt(_0x22541f.add(8)) + 1);
}, T: function (_0x5b4d03) {
  return Memory[_0x156a("0x18")](_0x5b4d03.add(12));
}, b: function (_0x1a8537) {
  return Memory[_0x156a("0x18")](_0x1a8537[_0x156a("0x17")](16));
}, A: function (_0x44d9e0, _0x385497) {
  Memory[_0x156a("0x19")](_0x44d9e0[_0x156a("0x17")](12), _0x385497);
}, S: function (_0x337818, _0x3556fa) {
  Memory.writeInt(_0x337818[_0x156a("0x17")](16), _0x3556fa);
}, w: function (_0x4ba84a, _0x3f10fe) {
  _0x1ec330(_0x4ba84a[_0x156a("0x1e")](4));
  var _0x4924a0 = _0x3f7b33.b(_0x4ba84a);
  _0x3f7b33.v(_0x4ba84a, _0x4924a0, _0x3f10fe), _0x3f7b33.S(_0x4ba84a, (_0x4924a0 + 1) % _0x3f7b33.l(_0x4ba84a)), _0x3f7b33.R(_0x4ba84a), _0x45a2d1(_0x4ba84a[_0x156a("0x1e")](4));
}, B: function (_0x6529bc) {
  var _0x21aa7b = null;
  if (_0x1ec330(_0x6529bc[_0x156a("0x1e")](4)), _0x3f7b33.p(_0x6529bc)) {
    var _0x1a0b09 = _0x3f7b33.T(_0x6529bc);
    _0x21aa7b = _0x3f7b33.d(_0x6529bc, _0x1a0b09), _0x3f7b33.A(_0x6529bc, (_0x1a0b09 + 1) % _0x3f7b33.l(_0x6529bc)), _0x3f7b33.N(_0x6529bc);
  }
  return _0x45a2d1(_0x6529bc[_0x156a("0x1e")](4)), _0x21aa7b;
}};
function _0x245a53() {
  Interceptor[_0x156a("0x1f")](Module[_0x156a("0x0")](_0x156a("0x1"), _0x156a("0x20")), {onEnter: function (_0x4f1b7a) {
    if (9339 === _0x5ae588(Memory[_0x156a("0x21")](_0x4f1b7a[1][_0x156a("0x17")](2)))) {
      if (_0x239fe4.fd = _0x4f1b7a[0][_0x156a("0x22")](), _0x239fe4[_0x156a("0x23")].redirectHost) {
        var _0x34247c = Memory[_0x156a("0x24")](_0x239fe4.options.redirectHost);
        Memory[_0x156a("0x19")](_0x4f1b7a[1][_0x156a("0x17")](4), _0x17e3ad(_0x34247c));
      }
      _0x4c3c8e();
    }
  }});
}
function _0x4c3c8e() {
  _0x239fe4[_0x156a("0x25")] = [];
  for (var _0x343608 = 0; _0x343608 < _0x469d01[_0x156a("0x26")]; _0x343608 += 1) _0x239fe4[_0x156a("0x25")][_0x156a("0x27")](_0x239fe4.base[_0x156a("0x17")](_0x469d01[_0x343608]));
  function _0x543f00() {
    for (var _0x343608 = _0x3f7b33.B(_0x239fe4[_0x156a("0x28")]); _0x343608;) {
      10100 === _0x4158c3.o(_0x343608) && (_0x343608 = Memory[_0x156a("0x1a")](_0x239fe4[_0x156a("0x29")]), Memory[_0x156a("0x1b")](_0x239fe4.loginMessagePtr, ptr(0))), _0x4158c3.c(_0x343608);
      var _0xe5370a = _0x4158c3.e(_0x343608), _0x2b6a29 = _0x385c38.a(_0xe5370a), _0x543f00 = _0x239fe4[_0x156a("0x2a")](_0x2b6a29 + 7);
      _0x69232a(_0x543f00[_0x156a("0x17")](7), _0x385c38.u(_0xe5370a), _0x2b6a29), _0x58c06e.h(_0x543f00, _0x2b6a29), _0x58c06e.f(_0x543f00, _0x4158c3.o(_0x343608)), _0x58c06e.g(_0x543f00, _0x4158c3.n(_0x343608)), _0xb09559(_0x239fe4.fd, _0x543f00, _0x2b6a29 + 7, 0), _0x3a74dd(_0x543f00), _0x4158c3.i(_0x343608), _0x343608 = _0x3f7b33.B(_0x239fe4[_0x156a("0x28")]);
    }
  }
  _0x239fe4.pthreadReturn = _0x239fe4[_0x156a("0x2b")][_0x156a("0x17")](_0x4bd429), _0x239fe4[_0x156a("0x2c")] = Memory.readPointer(_0x239fe4.base[_0x156a("0x17")](_0xee10aa)), _0x239fe4[_0x156a("0x2d")] = _0x239fe4[_0x156a("0x2b")][_0x156a("0x17")](_0x47056d), _0x239fe4[_0x156a("0x2e")] = Memory.readPointer(_0x239fe4[_0x156a("0x2c")][_0x156a("0x17")](4)), _0x239fe4[_0x156a("0x2f")] = Memory[_0x156a("0x1a")](_0x239fe4[_0x156a("0x2e")][_0x156a("0x17")](52)), _0x239fe4[_0x156a("0x30")] = _0x239fe4[_0x156a("0x2e")][_0x156a("0x17")](60), _0x239fe4[_0x156a("0x28")] = _0x239fe4[_0x156a("0x2e")][_0x156a("0x17")](84), _0x239fe4[_0x156a("0x31")] = _0x239fe4[_0x156a("0x2e")][_0x156a("0x17")](212), _0x239fe4[_0x156a("0x29")] = _0x239fe4[_0x156a("0x2e")][_0x156a("0x17")](216), _0x239fe4.newOperator = new NativeFunction(_0x239fe4[_0x156a("0x2b")][_0x156a("0x17")](_0x3cf931), _0x156a("0x3"), [_0x156a("0x5")]), _0x239fe4[_0x156a("0x32")] = new NativeFunction(_0x239fe4[_0x156a("0x2b")].add(_0xabda23), _0x156a("0x3"), [_0x156a("0x3"), _0x156a("0x5")]), Interceptor.replace(Module[_0x156a("0x0")](_0x156a("0x1"), _0x156a("0x6")), new NativeCallback(function (_0x343608) {
    if (!this[_0x156a("0x33")].equals(_0x239fe4[_0x156a("0x34")])) return _0x44ae0b(_0x343608);
    for (var _0x37df77 = Memory.readPointer(this[_0x156a("0x35")].sp[_0x156a("0x17")](4)), _0x5299d1 = 0; _0x5299d1 < _0x239fe4[_0x156a("0x25")].length; _0x5299d1 += 1) if (_0x37df77[_0x156a("0x36")](_0x239fe4[_0x156a("0x25")][_0x5299d1])) return _0x543f00(), 0;
    return _0x44ae0b(_0x343608);
  }, _0x156a("0x5"), [_0x156a("0x3")])), Interceptor[_0x156a("0x37")](Module[_0x156a("0x0")]("libc.so", "select"), new NativeCallback(function (_0x343608, _0x76ec46, _0x9eb652, _0x543f00, _0x364dc2) {
    var _0x4a2446 = _0x3e9865(_0x343608, _0x76ec46, _0x9eb652, _0x543f00, _0x364dc2);
    return this[_0x156a("0x33")][_0x156a("0x36")](_0x239fe4.selectReturn) && function () {
      var _0x343608 = _0x239fe4.newOperator(7);
      _0x30d332(_0x239fe4.fd, _0x343608, 7, 256);
      var _0x76ec46 = _0x58c06e.o(_0x343608);
      20104 === _0x76ec46 && Memory.writeInt(_0x239fe4[_0x156a("0x31")], 5);
      var _0x9eb652 = _0x58c06e.m(_0x343608), _0x543f00 = _0x58c06e.y(_0x343608);
      _0x3a74dd(_0x343608);
      var _0x364dc2 = _0x239fe4[_0x156a("0x2a")](_0x9eb652);
      _0x30d332(_0x239fe4.fd, _0x364dc2, _0x9eb652, 256);
      var _0x4a2446 = _0x239fe4[_0x156a("0x32")](_0x239fe4[_0x156a("0x2f")], _0x76ec46);
      _0x4158c3.t(_0x4a2446, _0x543f00);
      var _0x5e6fa8 = _0x4158c3.e(_0x4a2446);
      if (_0x385c38._(_0x5e6fa8, _0x9eb652), _0x9eb652) {
        var _0x1c4caf = _0x239fe4[_0x156a("0x2a")](_0x9eb652);
        _0x69232a(_0x1c4caf, _0x364dc2, _0x9eb652), _0x385c38.s(_0x5e6fa8, _0x1c4caf);
      }
      _0x4158c3.r(_0x4a2446), _0x3f7b33.w(_0x239fe4.recvQueue, _0x4a2446), _0x3a74dd(_0x364dc2);
    }(), _0x4a2446;
  }, _0x156a("0x5"), [_0x156a("0x5"), _0x156a("0x3"), _0x156a("0x3"), _0x156a("0x3"), _0x156a("0x3")]));
}
rpc[_0x156a("0x38")] = {init: function (_0x5d1e76, _0x19fd7e) {
  _0x239fe4[_0x156a("0x23")] = _0x19fd7e || {}, _0x3b63ae(_0x156a("0x39"), function () {
    Interceptor[_0x156a("0x3a")](), _0x239fe4[_0x156a("0x2b")] = Process.findModuleByName(_0x156a("0x39")).base, _0x245a53();
  });
}};
